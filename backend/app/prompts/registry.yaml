# AI 模板注册配置文件
# 用于注册和管理所有可用的 AI 生成模板

templates:
  # 环保应急预案模板（V1版本）
  - id: emergency_plan
    name: "突发环境事件应急预案"
    description: "用于生成符合 HJ941-2018 标准的环保应急预案"
    category: "environmental"
    version: "1.0.0"

    # 模板文件路径
    schema_path: "templates/emergency_plan.json"
    prompt_template_path: "templates/template_emergency_plan.jinja2"

    # 是否启用
    enabled: false  # 已被V2版本替代

    # AI 模型配置
    ai_config:
      model: "gpt-4"  # 可选：gpt-3.5-turbo, gpt-4, claude-3, etc.
      temperature: 0.7
      max_tokens: 2000

    # 缓存配置
    cache:
      enabled: true
      ttl: 3600  # 缓存时间（秒）

    # 所需的必填字段
    required_fields:
      - enterprise_info

  # 环境风险评估报告模板（V1版本）
  - id: risk_assessment
    name: "环境风险评估报告"
    description: "用于生成环境风险评估报告，分析企业环境风险"
    category: "environmental"
    version: "1.0.0"

    # 模板文件路径
    schema_path: "templates/emergency_plan.json"
    prompt_template_path: "templates/template_risk_plan.jinja2"

    # 是否启用
    enabled: false  # 已被V2版本替代

    # AI 模型配置
    ai_config:
      model: "gpt-4"
      temperature: 0.7
      max_tokens: 2000

    # 缓存配置
    cache:
      enabled: true
      ttl: 3600

    # 所需的必填字段
    required_fields:
      - enterprise_info

  # 应急资源调查报告模板（V1版本）
  - id: resource_investigation
    name: "应急资源调查报告"
    description: "用于生成应急资源调查报告，统计企业应急资源"
    category: "environmental"
    version: "1.0.0"

    # 模板文件路径
    schema_path: "templates/emergency_plan.json"
    prompt_template_path: "templates/template_resource_investigation.jinja2"

    # 是否启用
    enabled: false  # 已被V2版本替代

    # AI 模型配置
    ai_config:
      model: "gpt-4"
      temperature: 0.7
      max_tokens: 2000

    # 缓存配置
    cache:
      enabled: true
      ttl: 3600

    # 所需的必填字段
    required_fields:
      - enterprise_info

  # 环境风险评估报告模板（V2版本）
  - id: risk_assessment_v2
    name: "环境风险评估报告（V2版）"
    description: "用于生成符合HJ941-2018标准的环境风险评估报告，包含AI生成的15个专业段落"
    category: "environmental"
    version: "2.0.0"

    # 模板文件路径
    schema_path: "templates/emergency_plan.json"
    prompt_template_path: "templates/template_risk_plan_v2.jinja2.md"

    # 是否启用
    enabled: true

    # AI 模型配置
    ai_config:
      model: "gpt-4"
      temperature: 0.7
      max_tokens: 2000

    # 缓存配置
    cache:
      enabled: true
      ttl: 3600

    # 所需的必填字段
    required_fields:
      - basic_info
      - production_process
      - environment_info
      - compliance_info
      - emergency_resources

    # AI段落配置
    ai_sections:
      - enterprise_overview
      - location_description
      - terrain_description
      - weather_description
      - hydrology_description
      - production_process_description
      - safety_management_description
      - water_environment_impact
      - air_environment_impact
      - noise_environment_impact
      - solid_waste_impact
      - risk_management_conclusion
      - long_term_plan
      - medium_term_plan
      - short_term_plan

  # 突发环境事件应急预案模板（V2版本）
  - id: emergency_plan_v2
    name: "突发环境事件应急预案（V2版）"
    description: "用于生成符合法规要求的突发环境事件应急预案，包含AI生成的5个专业段落"
    category: "environmental"
    version: "2.0.0"

    # 模板文件路径
    schema_path: "templates/emergency_plan.json"
    prompt_template_path: "templates/template_emergency_plan_v2.jinja2.md"

    # 是否启用
    enabled: true

    # AI 模型配置
    ai_config:
      model: "gpt-4"
      temperature: 0.7
      max_tokens: 2000

    # 缓存配置
    cache:
      enabled: true
      ttl: 3600

    # 所需的必填字段
    required_fields:
      - basic_info
      - production_process
      - environment_info
      - compliance_info
      - emergency_resources

    # AI段落配置
    ai_sections:
      - environmental_work
      - construction_layout
      - risk_prevention_measures
      - emergency_response_measures
      - incident_response_card

  # 应急资源调查报告模板（V2版本）
  - id: resource_investigation_v2
    name: "应急资源调查报告（V2版）"
    description: "用于生成应急资源调查报告，包含AI生成的6个专业段落"
    category: "environmental"
    version: "2.0.0"

    # 模板文件路径
    schema_path: "templates/emergency_plan.json"
    prompt_template_path: "templates/template_resource_investigation_v2.jinja2.md"

    # 是否启用
    enabled: true

    # AI 模型配置
    ai_config:
      model: "gpt-4"
      temperature: 0.7
      max_tokens: 2000

    # 缓存配置
    cache:
      enabled: true
      ttl: 3600

    # 所需的必填字段
    required_fields:
      - basic_info
      - emergency_resources

    # AI段落配置
    ai_sections:
      - investigation_process
      - gap_analysis_1
      - gap_analysis_2
      - gap_analysis_3
      - gap_analysis_4
      - conclusion

  # 发布令模板（V2版本）
  - id: release_order_v2
    name: "发布令（V2版）"
    description: "用于生成应急预案发布令"
    category: "attachment"
    version: "2.0.0"

    # 模板文件路径
    schema_path: "templates/emergency_plan.json"
    prompt_template_path: "templates/attachments/attachment_release_order_v2.jinja2.md"

    # 是否启用
    enabled: true

    # AI 模型配置
    ai_config:
      model: "gpt-4"
      temperature: 0.7
      max_tokens: 2000

    # 缓存配置
    cache:
      enabled: true
      ttl: 3600

    # 所需的必填字段
    required_fields:
      - basic_info

    # AI段落配置
    ai_sections: []

  # 意见采纳情况表模板（V2版本）
  - id: opinion_adoption_v2
    name: "意见采纳情况表（V2版）"
    description: "用于生成专家评审意见采纳情况表"
    category: "attachment"
    version: "2.0.0"

    # 模板文件路径
    schema_path: "templates/emergency_plan.json"
    prompt_template_path: "templates/attachments/attachment_opinion_adoption_v2.jinja2.md"

    # 是否启用
    enabled: true

    # AI 模型配置
    ai_config:
      model: "gpt-4"
      temperature: 0.7
      max_tokens: 2000

    # 缓存配置
    cache:
      enabled: true
      ttl: 3600

    # 所需的必填字段
    required_fields:
      - basic_info
      - compliance_info

    # AI段落配置
    ai_sections: []

  # 应急监测方案模板（V2版本）
  - id: emergency_monitoring_plan_v2
    name: "应急监测方案（V2版）"
    description: "用于生成突发环境事件应急监测方案"
    category: "attachment"
    version: "2.0.0"

    # 模板文件路径
    schema_path: "templates/emergency_plan.json"
    prompt_template_path: "templates/attachments/attachment_emergency_monitoring_plan_v2.jinja2.md"

    # 是否启用
    enabled: true

    # AI 模型配置
    ai_config:
      model: "gpt-4"
      temperature: 0.7
      max_tokens: 2000

    # 缓存配置
    cache:
      enabled: true
      ttl: 3600

    # 所需的必填字段
    required_fields:
      - basic_info
      - emergency_resources
      - environment_info

    # AI段落配置
    ai_sections: []

  # 修编说明模板（V2版本）
  - id: revision_note_v2
    name: "修编说明（V2版）"
    description: "用于生成应急预案修编说明"
    category: "attachment"
    version: "2.0.0"

    # 模板文件路径
    schema_path: "templates/emergency_plan.json"
    prompt_template_path: "templates/attachments/attachment_revision_note_v2.jinja2.md"

    # 是否启用
    enabled: true

    # AI 模型配置
    ai_config:
      model: "gpt-4"
      temperature: 0.7
      max_tokens: 2000

    # 缓存配置
    cache:
      enabled: true
      ttl: 3600

    # 所需的必填字段
    required_fields:
      - basic_info
      - production_process
      - emergency_resources

    # AI段落配置
    ai_sections: []

  # 环评报告模板（示例，未来扩展）
  - id: environmental_assessment
    name: "环境影响评价报告"
    description: "环评报告自动生成模板"
    category: "environmental"
    version: "1.0.0"
    schema_path: "templates/environmental_assessment.json"
    prompt_template_path: "templates/environmental_assessment.jinja2"
    enabled: false  # 暂未实现
    ai_config:
      model: "gpt-4"
      temperature: 0.7
      max_tokens: 2000
    cache:
      enabled: true
      ttl: 3600

# 全局配置
global:
  # 模板目录
  templates_dir: "app/prompts/templates"

  # 日志配置
  logging:
    enabled: true
    level: "INFO"

  # 安全配置
  security:
    # 启用 Jinja2 沙箱模式
    enable_sandbox: true
    # 允许的变量白名单（防止模板注入）
    allowed_variables:
      - enterprise_info
      - hazardous_materials
      - surrounding_receptors
      - emergency_team_structure
      - emergency_resources
      - incident_types
      - response_steps
      - appendices
      - section_title
      - section_id
      # 基本信息字段
      - enterprise_name
      - unified_social_credit_code
      - legal_representative
      - contact_person
      - contact_phone
      - address
      - registered_capital
      - establishment_date
      - industry_type
      - business_scope
      - employee_count
      # 生产信息字段
      - main_products
      - production_capacity
      - production_process
      - working_system
      # 环境信息字段
      - location_type
      - geographic_coordinates
      - nearby_sensitive_points
      - weather_conditions
      - hydrological_conditions
      # 合规信息字段
      - environmental_permits
      - environmental_inspections
      - environmental_incidents
      # 应急资源字段
      - emergency_equipment
      - emergency_materials
      - emergency_team
      - emergency_plan
      # 风险评估字段
      - risk_identification
      - risk_analysis
      - risk_level
      - risk_control_measures
    # 最大模板大小（字节）
    max_template_size: 102400  # 100KB

  # 限流配置
  rate_limit:
    enabled: true
    requests_per_minute: 10
    requests_per_hour: 100
