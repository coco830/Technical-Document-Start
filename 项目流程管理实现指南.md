# é¡¹ç›®æµç¨‹ç®¡ç†å®ç°æŒ‡å—

æ ¹æ®æ¶æ„è®¾è®¡æ–‡æ¡£ï¼Œæˆ‘ä»¬éœ€è¦å®ç°ä»åˆ›å»ºé¡¹ç›®åˆ°å¯¼å‡ºPDFçš„å®Œæ•´æµç¨‹ç®¡ç†ï¼Œç¡®ä¿ç”¨æˆ·èƒ½å¤Ÿæ¸…æ™°åœ°äº†è§£æ¯ä¸ªæ­¥éª¤å¹¶é¡ºåˆ©å®Œæˆä»»åŠ¡ã€‚

## ä¸€ã€é¡¹ç›®æµç¨‹çŠ¶æ€å®šä¹‰

### 1.1 é¡¹ç›®çŠ¶æ€æšä¸¾

```typescript
// frontend/src/types/project.ts
export enum ProjectStatus {
  CREATED = 'created',           // å·²åˆ›å»º
  ENTERPRISE_INFO = 'enterprise_info',  // ä¼ä¸šä¿¡æ¯å¡«å†™ä¸­
  AI_GENERATING = 'ai_generating',      // AIç”Ÿæˆä¸­
  EDITING = 'editing',               // ç¼–è¾‘ä¸­
  REVIEWING = 'reviewing',           // å®¡æ ¸ä¸­
  COMPLETED = 'completed',           // å·²å®Œæˆ
  ARCHIVED = 'archived'             // å·²å½’æ¡£
}

export enum ProjectStep {
  CREATE = 'create',               // åˆ›å»ºé¡¹ç›®
  ENTERPRISE_BASIC = 'enterprise_basic',    // ä¼ä¸šåŸºæœ¬ä¿¡æ¯
  ENTERPRISE_PRODUCTION = 'enterprise_production',  // ç”Ÿäº§è¿‡ç¨‹ä¿¡æ¯
  ENTERPRISE_ENVIRONMENT = 'enterprise_environment',  // ç¯å¢ƒä¿¡æ¯
  ENTERPRISE_PERMITS = 'enterprise_permits',      // ç¯ä¿æ‰‹ç»­
  AI_GENERATE = 'ai_generate',      // AIç”Ÿæˆ
  EDIT_DOCUMENT = 'edit_document',   // ç¼–è¾‘æ–‡æ¡£
  EXPORT_DOCUMENT = 'export_document' // å¯¼å‡ºæ–‡æ¡£
}
```

### 1.2 é¡¹ç›®è¿›åº¦è®¡ç®—

```typescript
// frontend/src/utils/projectProgress.ts
import { ProjectStatus, ProjectStep } from '@/types/project'

export interface ProjectProgress {
  currentStep: ProjectStep
  completedSteps: ProjectStep[]
  totalSteps: number
  percentage: number
  stepProgress: Record<ProjectStep, number>
}

export const calculateProjectProgress = (project: any): ProjectProgress => {
  const steps = Object.values(ProjectStep)
  const totalSteps = steps.length
  
  // æ ¹æ®é¡¹ç›®æ•°æ®åˆ¤æ–­æ¯ä¸ªæ­¥éª¤çš„å®Œæˆæƒ…å†µ
  const stepProgress: Record<ProjectStep, number> = {
    [ProjectStep.CREATE]: project.id ? 100 : 0,
    [ProjectStep.ENTERPRISE_BASIC]: project.enterprise_info?.enterprise_name ? 100 : 0,
    [ProjectStep.ENTERPRISE_PRODUCTION]: project.enterprise_info?.production_info ? 100 : 0,
    [ProjectStep.ENTERPRISE_ENVIRONMENT]: project.enterprise_info?.environment_info ? 100 : 0,
    [ProjectStep.ENTERPRISE_PERMITS]: project.enterprise_info?.permits_info ? 100 : 0,
    [ProjectStep.AI_GENERATE]: project.documents?.some(doc => doc.ai_generated) ? 100 : 0,
    [ProjectStep.EDIT_DOCUMENT]: project.documents?.some(doc => doc.content && doc.content.length > 0) ? 100 : 0,
    [ProjectStep.EXPORT_DOCUMENT]: project.exports?.length > 0 ? 100 : 0,
  }
  
  // è®¡ç®—å®Œæˆçš„æ­¥éª¤
  const completedSteps = steps.filter(step => stepProgress[step] === 100)
  
  // æ‰¾å‡ºå½“å‰æ­¥éª¤
  const currentStep = steps.find(step => stepProgress[step] < 100) || ProjectStep.EXPORT_DOCUMENT
  
  // è®¡ç®—æ€»ä½“è¿›åº¦ç™¾åˆ†æ¯”
  const completedPercentage = completedSteps.reduce((sum, step) => sum + stepProgress[step], 0)
  const percentage = Math.round(completedPercentage / totalSteps)
  
  return {
    currentStep,
    completedSteps,
    totalSteps,
    percentage,
    stepProgress
  }
}
```

## äºŒã€é¡¹ç›®æµç¨‹ç»„ä»¶

### 2.1 é¡¹ç›®è¿›åº¦æŒ‡ç¤ºå™¨

```typescript
// frontend/src/components/ProjectProgressIndicator.tsx
import React from 'react'
import { ProjectProgress, ProjectStep } from '@/types/project'

interface ProjectProgressIndicatorProps {
  progress: ProjectProgress
  onStepClick?: (step: ProjectStep) => void
  currentProjectId?: number
}

const stepLabels: Record<ProjectStep, string> = {
  [ProjectStep.CREATE]: 'åˆ›å»ºé¡¹ç›®',
  [ProjectStep.ENTERPRISE_BASIC]: 'ä¼ä¸šåŸºæœ¬ä¿¡æ¯',
  [ProjectStep.ENTERPRISE_PRODUCTION]: 'ç”Ÿäº§è¿‡ç¨‹ä¿¡æ¯',
  [ProjectStep.ENTERPRISE_ENVIRONMENT]: 'ç¯å¢ƒä¿¡æ¯',
  [ProjectStep.ENTERPRISE_PERMITS]: 'ç¯ä¿æ‰‹ç»­',
  [ProjectStep.AI_GENERATE]: 'AIç”Ÿæˆ',
  [ProjectStep.EDIT_DOCUMENT]: 'ç¼–è¾‘æ–‡æ¡£',
  [ProjectStep.EXPORT_DOCUMENT]: 'å¯¼å‡ºæ–‡æ¡£'
}

const stepIcons: Record<ProjectStep, string> = {
  [ProjectStep.CREATE]: 'ğŸ“',
  [ProjectStep.ENTERPRISE_BASIC]: 'ğŸ¢',
  [ProjectStep.ENTERPRISE_PRODUCTION]: 'ğŸ­',
  [ProjectStep.ENTERPRISE_ENVIRONMENT]: 'ğŸŒ',
  [ProjectStep.ENTERPRISE_PERMITS]: 'ğŸ“œ',
  [ProjectStep.AI_GENERATE]: 'ğŸ¤–',
  [ProjectStep.EDIT_DOCUMENT]: 'âœï¸',
  [ProjectStep.EXPORT_DOCUMENT]: 'ğŸ“¤'
}

export default function ProjectProgressIndicator({ 
  progress, 
  onStepClick, 
  currentProjectId 
}: ProjectProgressIndicatorProps) {
  const steps = Object.values(ProjectStep)
  
  return (
    <div className="bg-white rounded-lg shadow-md p-6">
      <h3 className="text-lg font-semibold mb-4">é¡¹ç›®è¿›åº¦</h3>
      
      {/* è¿›åº¦æ¡ */}
      <div className="mb-6">
        <div className="flex justify-between items-center mb-2">
          <span className="text-sm text-gray-600">å®Œæˆè¿›åº¦</span>
          <span className="text-sm font-medium text-gray-900">{progress.percentage}%</span>
        </div>
        <div className="w-full bg-gray-200 rounded-full h-3">
          <div
            className="bg-primary h-3 rounded-full transition-all duration-300"
            style={{ width: `${progress.percentage}%` }}
          ></div>
        </div>
      </div>
      
      {/* æ­¥éª¤åˆ—è¡¨ */}
      <div className="space-y-3">
        {steps.map((step, index) => {
          const isCompleted = progress.completedSteps.includes(step)
          const isCurrent = step === progress.currentStep
          const stepPercentage = progress.stepProgress[step]
          
          return (
            <div
              key={step}
              className={`flex items-center p-3 rounded-lg border transition-all cursor-pointer ${
                isCompleted 
                  ? 'border-green-300 bg-green-50' 
                  : isCurrent 
                    ? 'border-primary bg-primary/10' 
                    : 'border-gray-200 bg-gray-50'
              }`}
              onClick={() => onStepClick?.(step)}
            >
              {/* æ­¥éª¤åºå·å’Œå›¾æ ‡ */}
              <div className={`flex items-center justify-center w-10 h-10 rounded-full mr-4 ${
                isCompleted 
                  ? 'bg-green-500 text-white' 
                  : isCurrent 
                    ? 'bg-primary text-white' 
                    : 'bg-gray-300 text-gray-600'
              }`}>
                {isCompleted ? 'âœ“' : stepIcons[step]}
              </div>
              
              {/* æ­¥éª¤ä¿¡æ¯ */}
              <div className="flex-1">
                <div className="flex items-center">
                  <span className={`font-medium ${
                    isCompleted || isCurrent ? 'text-gray-900' : 'text-gray-500'
                  }`}>
                    {index + 1}. {stepLabels[step]}
                  </span>
                  {isCurrent && (
                    <span className="ml-2 px-2 py-1 bg-primary text-white text-xs rounded-full">
                      å½“å‰
                    </span>
                  )}
                </div>
                
                {/* æ­¥éª¤è¿›åº¦æ¡ */}
                {stepPercentage > 0 && stepPercentage < 100 && (
                  <div className="mt-2">
                    <div className="w-full bg-gray-200 rounded-full h-1">
                      <div
                        className="bg-primary h-1 rounded-full"
                        style={{ width: `${stepPercentage}%` }}
                      ></div>
                    </div>
                  </div>
                )}
              </div>
              
              {/* æ“ä½œæŒ‰é’® */}
              {isCurrent && currentProjectId && (
                <button
                  className="ml-4 px-3 py-1 bg-primary text-white text-sm rounded-md hover:bg-green-700 transition-colors"
                  onClick={(e) => {
                    e.stopPropagation()
                    onStepClick?.(step)
                  }}
                >
                  ç»§ç»­
                </button>
              )}
            </div>
          )
        })}
      </div>
    </div>
  )
}
```

### 2.2 é¡¹ç›®æµç¨‹ç®¡ç†å™¨

```typescript
// frontend/src/components/ProjectFlowManager.tsx
import React, { useState, useEffect } from 'react'
import { useNavigate, useParams } from 'react-router-dom'
import { apiClient } from '@/utils/api'
import { ProjectStep, calculateProjectProgress } from '@/types/project'
import ProjectProgressIndicator from './ProjectProgressIndicator'

interface Project {
  id: number
  title: string
  status: string
  enterprise_info?: any
  documents?: any[]
  exports?: any[]
}

export default function ProjectFlowManager() {
  const navigate = useNavigate()
  const { id } = useParams<{ id: string }>()
  const [project, setProject] = useState<Project | null>(null)
  const [loading, setLoading] = useState(true)
  const [progress, setProgress] = useState<any>(null)

  useEffect(() => {
    if (id) {
      fetchProject(parseInt(id))
    }
  }, [id])

  const fetchProject = async (projectId: number) => {
    try {
      setLoading(true)
      const response = await apiClient.get(`/projects/${projectId}`)
      setProject(response.data)
      setProgress(calculateProjectProgress(response.data))
    } catch (error) {
      console.error('è·å–é¡¹ç›®ä¿¡æ¯å¤±è´¥:', error)
    } finally {
      setLoading(false)
    }
  }

  const handleStepClick = (step: ProjectStep) => {
    if (!project?.id) return

    const stepRoutes: Record<ProjectStep, string> = {
      [ProjectStep.CREATE]: `/projects?action=create`,
      [ProjectStep.ENTERPRISE_BASIC]: `/projects/${project.id}/enterprise-info`,
      [ProjectStep.ENTERPRISE_PRODUCTION]: `/projects/${project.id}/enterprise-info?step=production`,
      [ProjectStep.ENTERPRISE_ENVIRONMENT]: `/projects/${project.id}/enterprise-info?step=environment`,
      [ProjectStep.ENTERPRISE_PERMITS]: `/projects/${project.id}/enterprise-info?step=permits`,
      [ProjectStep.AI_GENERATE]: `/projects/${project.id}/ai-generate`,
      [ProjectStep.EDIT_DOCUMENT]: `/projects/${project.id}/editor`,
      [ProjectStep.EXPORT_DOCUMENT]: `/projects/${project.id}/export`
    }

    navigate(stepRoutes[step])
  }

  if (loading) {
    return (
      <div className="flex items-center justify-center h-64">
        <div className="animate-spin rounded-full h-12 w-12 border-b-2 border-primary"></div>
      </div>
    )
  }

  if (!project) {
    return (
      <div className="text-center py-8">
        <p className="text-gray-500">é¡¹ç›®ä¸å­˜åœ¨æˆ–å·²è¢«åˆ é™¤</p>
      </div>
    )
  }

  return (
    <div className="space-y-6">
      {/* é¡¹ç›®æ ‡é¢˜ */}
      <div className="bg-white rounded-lg shadow-md p-6">
        <h1 className="text-2xl font-bold text-gray-900 mb-2">{project.title}</h1>
        <p className="text-gray-600">é¡¹ç›®ID: {project.id}</p>
      </div>

      {/* é¡¹ç›®è¿›åº¦ */}
      {progress && (
        <ProjectProgressIndicator
          progress={progress}
          onStepClick={handleStepClick}
          currentProjectId={project.id}
        />
      )}
    </div>
  )
}
```

## ä¸‰ã€ä¼ä¸šä¿¡æ¯åˆ†æ­¥è¡¨å•

### 3.1 ä¼ä¸šä¿¡æ¯æ­¥éª¤å¯¼èˆª

```typescript
// frontend/src/components/EnterpriseInfoSteps.tsx
import React from 'react'
import { useNavigate, useSearchParams } from 'react-router-dom'
import { ProjectStep } from '@/types/project'

interface EnterpriseInfoStepsProps {
  currentStep: ProjectStep
  projectId: number
  completedSteps: ProjectStep[]
}

const steps = [
  {
    key: ProjectStep.ENTERPRISE_BASIC,
    label: 'åŸºæœ¬ä¿¡æ¯',
    icon: 'ğŸ¢',
    description: 'ä¼ä¸šåç§°ã€åœ°å€ã€è”ç³»æ–¹å¼ç­‰'
  },
  {
    key: ProjectStep.ENTERPRISE_PRODUCTION,
    label: 'ç”Ÿäº§è¿‡ç¨‹',
    icon: 'ğŸ­',
    description: 'ä¸»è¦äº§å“ã€ç”Ÿäº§å·¥è‰ºã€ç”Ÿäº§è®¾æ–½ç­‰'
  },
  {
    key: ProjectStep.ENTERPRISE_ENVIRONMENT,
    label: 'ç¯å¢ƒä¿¡æ¯',
    icon: 'ğŸŒ',
    description: 'åœ°ç†ä½ç½®ã€å‘¨è¾¹ç¯å¢ƒã€æ°”è±¡æ°´æ–‡ç­‰'
  },
  {
    key: ProjectStep.ENTERPRISE_PERMITS,
    label: 'ç¯ä¿æ‰‹ç»­',
    icon: 'ğŸ“œ',
    description: 'ç¯è¯„æ‰¹å¤ã€éªŒæ”¶æ–‡ä»¶ã€æ’æ±¡è®¸å¯è¯ç­‰'
  }
]

export default function EnterpriseInfoSteps({ 
  currentStep, 
  projectId, 
  completedSteps 
}: EnterpriseInfoStepsProps) {
  const navigate = useNavigate()
  const [searchParams] = useSearchParams()

  const handleStepClick = (step: ProjectStep) => {
    const stepQueries: Record<ProjectStep, string> = {
      [ProjectStep.ENTERPRISE_BASIC]: '',
      [ProjectStep.ENTERPRISE_PRODUCTION]: 'step=production',
      [ProjectStep.ENTERPRISE_ENVIRONMENT]: 'step=environment',
      [ProjectStep.ENTERPRISE_PERMITS]: 'step=permits'
    }

    const query = stepQueries[step]
    const url = `/projects/${projectId}/enterprise-info${query ? `?${query}` : ''}`
    navigate(url)
  }

  const getCurrentStepIndex = () => {
    return steps.findIndex(step => step.key === currentStep)
  }

  const canNavigateToStep = (step: ProjectStep) => {
    // åªèƒ½å¯¼èˆªåˆ°å·²å®Œæˆçš„æ­¥éª¤æˆ–ä¸‹ä¸€ä¸ªæœªå®Œæˆçš„æ­¥éª¤
    const currentIndex = getCurrentStepIndex()
    const stepIndex = steps.findIndex(s => s.key === step)
    return stepIndex <= currentIndex + 1
  }

  return (
    <div className="bg-white rounded-lg shadow-md p-6">
      <h2 className="text-xl font-semibold mb-6">ä¼ä¸šä¿¡æ¯å¡«å†™</h2>
      
      {/* æ­¥éª¤å¯¼èˆª */}
      <div className="flex flex-wrap justify-between mb-8">
        {steps.map((step, index) => {
          const isCompleted = completedSteps.includes(step.key)
          const isCurrent = step.key === currentStep
          const canNavigate = canNavigateToStep(step.key)
          
          return (
            <div
              key={step.key}
              className={`flex flex-col items-center p-4 rounded-lg border-2 transition-all cursor-pointer ${
                isCompleted 
                  ? 'border-green-300 bg-green-50' 
                  : isCurrent 
                    ? 'border-primary bg-primary/10' 
                    : canNavigate
                      ? 'border-gray-300 bg-white hover:border-gray-400'
                      : 'border-gray-200 bg-gray-100 cursor-not-allowed opacity-50'
              }`}
              onClick={() => canNavigate && handleStepClick(step.key)}
            >
              {/* æ­¥éª¤å›¾æ ‡ */}
              <div className={`flex items-center justify-center w-12 h-12 rounded-full mb-3 ${
                isCompleted 
                  ? 'bg-green-500 text-white' 
                  : isCurrent 
                    ? 'bg-primary text-white' 
                    : 'bg-gray-300 text-gray-600'
              }`}>
                {isCompleted ? 'âœ“' : step.icon}
              </div>
              
              {/* æ­¥éª¤æ ‡ç­¾ */}
              <span className={`font-medium text-center ${
                isCompleted || isCurrent ? 'text-gray-900' : 'text-gray-500'
              }`}>
                {step.label}
              </span>
              
              {/* æ­¥éª¤æè¿° */}
              <p className="text-xs text-gray-600 mt-2 text-center max-w-24">
                {step.description}
              </p>
            </div>
          )
        })}
      </div>
      
      {/* è¿›åº¦æŒ‡ç¤ºå™¨ */}
      <div className="mt-6">
        <div className="flex justify-between items-center mb-2">
          <span className="text-sm text-gray-600">å®Œæˆè¿›åº¦</span>
          <span className="text-sm font-medium text-gray-900">
            {completedSteps.length} / {steps.length}
          </span>
        </div>
        <div className="w-full bg-gray-200 rounded-full h-2">
          <div
            className="bg-primary h-2 rounded-full transition-all duration-300"
            style={{ width: `${(completedSteps.length / steps.length) * 100}%` }}
          ></div>
        </div>
      </div>
    </div>
  )
}
```

## å››ã€AIç”Ÿæˆæµç¨‹ç®¡ç†

### 4.1 AIç”Ÿæˆè¿›åº¦ç»„ä»¶

```typescript
// frontend/src/components/AIGenerationProgress.tsx
import React, { useState, useEffect } from 'react'
import { apiClient } from '@/utils/api'

interface AIGenerationProgressProps {
  projectId: number
  onGenerationComplete: () => void
}

interface GenerationStep {
  id: string
  title: string
  status: 'pending' | 'generating' | 'completed' | 'error'
  progress: number
  content?: string
}

export default function AIGenerationProgress({ 
  projectId, 
  onGenerationComplete 
}: AIGenerationProgressProps) {
  const [steps, setSteps] = useState<GenerationStep[]>([
    { id: 'chapter1', title: 'ä¼ä¸šæ¦‚å†µ', status: 'pending', progress: 0 },
    { id: 'chapter2', title: 'åº”æ€¥ç»„ç»‡æœºæ„', status: 'pending', progress: 0 },
    { id: 'chapter3', title: 'åº”æ€¥å“åº”æµç¨‹', status: 'pending', progress: 0 },
    { id: 'chapter4', title: 'åº”æ€¥å¤„ç½®æªæ–½', status: 'pending', progress: 0 },
    { id: 'chapter5', title: 'åº”æ€¥èµ„æºä¿éšœ', status: 'pending', progress: 0 }
  ])
  const [currentStep, setCurrentStep] = useState(0)
  const [isGenerating, setIsGenerating] = useState(false)

  const startGeneration = async () => {
    try {
      setIsGenerating(true)
      
      // é€ä¸ªç”Ÿæˆç« èŠ‚
      for (let i = 0; i < steps.length; i++) {
        setCurrentStep(i)
        
        // æ›´æ–°å½“å‰æ­¥éª¤çŠ¶æ€
        setSteps(prev => prev.map((step, index) => 
          index === i 
            ? { ...step, status: 'generating', progress: 0 }
            : step
        ))
        
        // è°ƒç”¨AIç”ŸæˆAPI
        const response = await apiClient.post('/ai/generate', {
          template_id: 'emergency_plan',
          section_id: steps[i].id,
          project_id: projectId
        })
        
        // æ¨¡æ‹Ÿè¿›åº¦æ›´æ–°
        for (let progress = 0; progress <= 100; progress += 10) {
          await new Promise(resolve => setTimeout(resolve, 100))
          setSteps(prev => prev.map((step, index) => 
            index === i 
              ? { ...step, progress }
              : step
          ))
        }
        
        // æ›´æ–°æ­¥éª¤å®ŒæˆçŠ¶æ€
        setSteps(prev => prev.map((step, index) => 
          index === i 
            ? { ...step, status: 'completed', progress: 100, content: response.data.content }
            : step
        ))
      }
      
      setIsGenerating(false)
      onGenerationComplete()
    } catch (error) {
      console.error('AIç”Ÿæˆå¤±è´¥:', error)
      
      // æ›´æ–°é”™è¯¯çŠ¶æ€
      setSteps(prev => prev.map((step, index) => 
        index === currentStep 
          ? { ...step, status: 'error' }
          : step
      ))
      
      setIsGenerating(false)
    }
  }

  const retryGeneration = () => {
    startGeneration()
  }

  const getStepIcon = (status: string) => {
    switch (status) {
      case 'completed': return 'âœ…'
      case 'generating': return 'â³'
      case 'error': return 'âŒ'
      default: return 'â­•'
    }
  }

  const getStepColor = (status: string) => {
    switch (status) {
      case 'completed': return 'text-green-600'
      case 'generating': return 'text-blue-600'
      case 'error': return 'text-red-600'
      default: return 'text-gray-400'
    }
  }

  return (
    <div className="bg-white rounded-lg shadow-md p-6">
      <h2 className="text-xl font-semibold mb-6">AIç”Ÿæˆè¿›åº¦</h2>
      
      {/* ç”ŸæˆæŒ‰é’® */}
      {!isGenerating && (
        <div className="text-center mb-6">
          <button
            onClick={startGeneration}
            className="bg-primary text-white px-6 py-3 rounded-md hover:bg-green-700 transition-colors"
          >
            å¼€å§‹AIç”Ÿæˆ
          </button>
        </div>
      )}
      
      {/* è¿›åº¦åˆ—è¡¨ */}
      <div className="space-y-4">
        {steps.map((step, index) => (
          <div
            key={step.id}
            className={`border rounded-lg p-4 ${
              index === currentStep ? 'border-primary bg-primary/5' : 'border-gray-200'
            }`}
          >
            <div className="flex items-center justify-between mb-2">
              <div className="flex items-center">
                <span className={`text-lg mr-3 ${getStepColor(step.status)}`}>
                  {getStepIcon(step.status)}
                </span>
                <span className="font-medium">{step.title}</span>
              </div>
              
              {step.status === 'generating' && (
                <span className="text-sm text-blue-600">ç”Ÿæˆä¸­...</span>
              )}
              
              {step.status === 'error' && (
                <button
                  onClick={retryGeneration}
                  className="text-sm text-red-600 hover:text-red-800"
                >
                  é‡è¯•
                </button>
              )}
            </div>
            
            {/* è¿›åº¦æ¡ */}
            {(step.status === 'generating' || step.status === 'completed') && (
              <div className="w-full bg-gray-200 rounded-full h-2">
                <div
                  className={`h-2 rounded-full transition-all duration-300 ${
                    step.status === 'completed' ? 'bg-green-500' : 'bg-blue-500'
                  }`}
                  style={{ width: `${step.progress}%` }}
                ></div>
              </div>
            )}
            
            {/* ç”Ÿæˆçš„å†…å®¹é¢„è§ˆ */}
            {step.status === 'completed' && step.content && (
              <div className="mt-3 p-3 bg-gray-50 rounded text-sm">
                <div className="text-gray-600 mb-1">ç”Ÿæˆå†…å®¹é¢„è§ˆ:</div>
                <div className="text-gray-800 line-clamp-3">
                  {step.content.substring(0, 200)}...
                </div>
              </div>
            )}
          </div>
        ))}
      </div>
      
      {/* å®Œæˆæç¤º */}
      {steps.every(step => step.status === 'completed') && (
        <div className="mt-6 p-4 bg-green-50 border border-green-200 rounded-lg">
          <div className="flex items-center">
            <span className="text-green-600 text-lg mr-3">âœ…</span>
            <div>
              <h3 className="font-medium text-green-800">ç”Ÿæˆå®Œæˆ</h3>
              <p className="text-green-700 text-sm">æ‰€æœ‰ç« èŠ‚å·²æˆåŠŸç”Ÿæˆï¼Œå¯ä»¥è¿›å…¥ç¼–è¾‘å™¨è¿›è¡Œä¿®æ”¹</p>
            </div>
          </div>
          <div className="mt-4">
            <button
              onClick={onGenerationComplete}
              className="bg-primary text-white px-4 py-2 rounded-md hover:bg-green-700 transition-colors"
            >
              è¿›å…¥ç¼–è¾‘å™¨
            </button>
          </div>
        </div>
      )}
    </div>
  )
}
```

## äº”ã€å®æ–½æ­¥éª¤

1. **ç¬¬ä¸€é˜¶æ®µ**: å®ç°é¡¹ç›®çŠ¶æ€å’Œè¿›åº¦è®¡ç®—é€»è¾‘
2. **ç¬¬äºŒé˜¶æ®µ**: åˆ›å»ºé¡¹ç›®è¿›åº¦æŒ‡ç¤ºå™¨ç»„ä»¶
3. **ç¬¬ä¸‰é˜¶æ®µ**: å®ç°ä¼ä¸šä¿¡æ¯åˆ†æ­¥è¡¨å•
4. **ç¬¬å››é˜¶æ®µ**: å¼€å‘AIç”Ÿæˆè¿›åº¦ç»„ä»¶
5. **ç¬¬äº”é˜¶æ®µ**: é›†æˆåˆ°ç°æœ‰é¡µé¢ä¸­
6. **ç¬¬å…­é˜¶æ®µ**: æµ‹è¯•å’Œä¼˜åŒ–

## å…­ã€é¢„æœŸæ•ˆæœ

1. **æµç¨‹æ¸…æ™°**: ç”¨æˆ·èƒ½å¤Ÿæ¸…æ¥šäº†è§£é¡¹ç›®å½“å‰çŠ¶æ€å’Œä¸‹ä¸€æ­¥æ“ä½œ
2. **è¿›åº¦å¯è§†åŒ–**: ç›´è§‚æ˜¾ç¤ºé¡¹ç›®å®Œæˆè¿›åº¦
3. **æ­¥éª¤å¼•å¯¼**: æä¾›æ˜ç¡®çš„æ­¥éª¤å¯¼èˆªå’Œæ“ä½œæŒ‡å¼•
4. **çŠ¶æ€ç®¡ç†**: æœ‰æ•ˆç®¡ç†é¡¹ç›®çŠ¶æ€è½¬æ¢
5. **ç”¨æˆ·ä½“éªŒ**: å‡å°‘ç”¨æˆ·å›°æƒ‘ï¼Œæé«˜æ“ä½œæ•ˆç‡

é€šè¿‡ä»¥ä¸Šå®ç°ï¼Œç”¨æˆ·å°†èƒ½å¤Ÿè½»æ¾åœ°å®Œæˆä»åˆ›å»ºé¡¹ç›®åˆ°å¯¼å‡ºPDFçš„æ•´ä¸ªæµç¨‹ï¼Œç³»ç»Ÿå°†æä¾›æ¸…æ™°çš„æŒ‡å¼•å’ŒçŠ¶æ€åé¦ˆã€‚